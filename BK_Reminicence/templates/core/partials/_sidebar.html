<aside class="sidebar">
    <nav class="sidebar-nav">
        <ul>
            <li><a href="{% url 'core:index' %}"><i class="fas fa-home"></i> <span>Inicio</span></a></li>
            <li><a href="#"><i class="fas fa-search"></i> <span>Buscar</span></a></li>
        </ul>
    </nav>

    <div class="library">
        <div class="library-header">
            <button class="library-button">
                <i class="fas fa-book"></i>
                <span>Tu biblioteca</span>
            </button>
            <button class="icon-button">
                <i class="fas fa-plus"></i>
            </button>
        </div>

        <div class="library-filters">
            <span class="chip">Playlists</span>
            <span class="chip">Artistas</span>
            <span class="chip">Álbumes</span>
        </div>

        <div class="library-content">
            <div class="library-search">
                <i class="fas fa-search"></i>
                <span>Recientes</span>
                <i class="fas fa-list"></i>
            </div>
            
            <ul class="playlist-list">
                {% if spotify_connected %}
                    {% for playlist in user_playlists %}
                    <!-- CAMBIOS AQUÍ: Añadida la clase 'song-item' y el atributo 'data-spotify-uri' al <li> -->
                    <li class="playlist-item song-item" data-spotify-uri="{{ playlist.uri }}">
                        <img src="{{ playlist.image|default:'https://via.placeholder.com/48' }}" alt="{{ playlist.name }}">
                        <div class="playlist-info">
                            <span class="playlist-name">{{ playlist.name }}</span>
                            <span class="playlist-details">{{ playlist.type }} • {{ playlist.owner }}</span>
                        </div>
                    </li>
                    {% empty %}
                    <li class="playlist-item">
                        <p style="color: #b3b3b3; padding: 1rem;">No se encontraron playlists</p>
                    </li>
                    {% endfor %}
                {% else %}
                    <li class="playlist-item" style="padding: 1rem;">
                        <p style="color: #b3b3b3; margin-bottom: 0.5rem;">Conecta tu cuenta de Spotify</p>
                        <!-- URL Corregida con la etiqueta de Django -->
                        <a href="{% url 'spotify_api:spotify_login' %}" style="color: #1db954; text-decoration: underline;">Conectar Spotify</a>
                    </li>
                {% endif %}
            </ul>
        </div>
    </div>
</aside>

